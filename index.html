<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Spacelabs provides cutting-edge aerospace technology, simulation, and software solutions for space and defense missions.">
    <meta name="keywords"
        content="Spacelabs, Aerospace Technology, Space Simulation, Defense Software, Satellite Systems">
    <meta name="author" content="Spacelabs">

    <!-- Restored Favicons -->
    <link rel="icon" type="image/x-icon" href="/favicon2/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon2/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon2/favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon2/apple-touch-icon.png">
    <link rel="manifest" href="/favicon2/site.webmanifest">

    <title>Spacelabs | Innovation in Space</title>

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- AOS Animation Library -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <!-- Google Fonts: Orbitron & Exo 2 for Sci-Fi look -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;400;600&family=Orbitron:wght@400;700;900&display=swap"
        rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        :root {
            --primary: #d412a1;
            /* Your Brand Purple */
            --primary-glow: rgba(212, 18, 161, 0.5);
            --dark-bg: #050505;
            --card-bg: rgba(20, 20, 20, 0.7);
            --text-main: #ffffff;
            --text-muted: #a0a0a0;
            --text-bright: #e0e0e0;
            /* Lighter text for descriptions */
        }

        body {
            background-color: var(--dark-bg);
            color: var(--text-main);
            font-family: 'Exo 2', sans-serif;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        /* Prevent horizontal scroll on mobile */
        * {
            max-width: 100%;
        }

        img {
            max-width: 100%;
            height: auto;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        .navbar-brand {
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
        }

        /* --- Custom Scrollbar --- */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--dark-bg);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        /* --- Navigation --- */
        .navbar {
            background: rgba(5, 5, 5, 0.95);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            padding: 1rem 0;
        }

        .navbar-brand img {
            height: 50px;
            /* Adjusted height for your logo */
            width: auto;
        }

        .nav-link {
            color: var(--text-main) !important;
            font-weight: 500;
            margin-left: 20px;
            position: relative;
            transition: color 0.3s;
        }

        .nav-link:hover,
        .nav-link.active {
            color: var(--primary) !important;
            text-shadow: 0 0 10px var(--primary-glow);
        }

        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 0;
            background-color: var(--primary);
            transition: width 0.3s;
        }

        .nav-link:hover::after {
            width: 100%;
        }

        /* --- Hero Section --- */
        .hero-section {
            position: relative;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background: radial-gradient(circle at center, #1a0214 0%, #000000 100%);
            padding: 40px 0 60px;
        }

        .aurora-band {
            position: absolute;
            width: 140%;
            height: 250px;
            left: -20%;
            background: linear-gradient(120deg, rgba(60, 255, 199, 0.08), rgba(212, 18, 161, 0.25), rgba(120, 200, 255, 0.08));
            filter: blur(60px);
            opacity: 0.35;
            animation: auroraDrift 18s ease-in-out infinite alternate;
            pointer-events: none;
        }

        .aurora-band.band-2 {
            top: 20%;
            animation-duration: 26s;
            animation-delay: -8s;
            opacity: 0.25;
            transform: rotate(-5deg);
        }

        .aurora-band.band-1 {
            top: 5%;
            transform: rotate(8deg);
        }

        @keyframes auroraDrift {
            0% {
                transform: translateY(0) rotate(5deg);
            }

            50% {
                transform: translateY(20px) rotate(-2deg);
            }

            100% {
                transform: translateY(-15px) rotate(6deg);
            }
        }

        /* Overview carousel styling */
        .overview-carousel {
            border: 1px solid var(--primary);
            box-shadow: 0 0 20px rgba(212, 18, 161, 0.3);
            border-radius: 1.25rem;
            overflow: hidden;
            position: relative;
        }

        .overview-carousel .carousel-item img {
            object-fit: cover;
            width: 100%;
            height: 360px;
            filter: brightness(0.9);
        }

        .overview-carousel .carousel-caption {
            text-align: left;
            background: linear-gradient(90deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0));
            border-radius: 1rem;
            padding: 1.5rem;
        }

        .overview-carousel .carousel-caption h3 {
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
            margin-bottom: 0.4rem;
        }

        .overview-carousel .carousel-caption p {
            margin-bottom: 0;
            color: var(--text-bright);
        }

        /* Responsive carousel caption */
        @media (max-width: 768px) {
            .overview-carousel .carousel-caption {
                padding: 1rem;
            }

            .overview-carousel .carousel-caption h3 {
                font-size: 1.1rem;
                margin-bottom: 0.3rem;
            }

            .overview-carousel .carousel-caption p {
                font-size: 0.85rem;
            }
        }

        @media (max-width: 576px) {
            .overview-carousel .carousel-caption {
                padding: 0.75rem;
            }

            .overview-carousel .carousel-caption h3 {
                font-size: 1rem;
                margin-bottom: 0.25rem;
            }

            .overview-carousel .carousel-caption p {
                font-size: 0.8rem;
            }
        }

        .overview-carousel .carousel-indicators [data-bs-target] {
            background-color: var(--primary);
        }

        .overview-carousel .carousel-indicators {
            margin-bottom: 0.75rem;
        }

        /* --- Responsive Styles --- */

        /* Large Tablets and Small Desktops */
        @media (max-width: 1199px) {
            .section-padding {
                padding: 80px 0;
            }

            .hero-title {
                font-size: 3rem;
            }

            .section-title {
                font-size: 2.5rem;
            }
        }

        /* Tablets */
        @media (max-width: 991px) {
            .hero-section {
                height: auto;
                min-height: 100vh;
                padding: 60px 0 70px;
            }

            .hero-content {
                padding-top: 130px;
            }

            .hero-planet {
                max-width: 160px;
                margin-top: 0;
                margin-bottom: 1.5rem;
            }

            .hero-title {
                font-size: 2.6rem;
                line-height: 1.2;
                margin-bottom: 1rem;
            }

            .hero-subtitle {
                font-size: 1rem;
                padding: 0 15px;
                line-height: 1.6;
                margin-bottom: 1.5rem;
            }

            .orbit-container {
                display: none;
            }

            .aurora-band {
                opacity: 0.2;
            }

            .overview-carousel .carousel-item img {
                height: 280px;
            }

            .section-padding {
                padding: 70px 0;
            }

            .section-title {
                font-size: 2.2rem;
                margin-bottom: 2rem;
            }

            .glass-card {
                padding: 1.5rem;
            }

            .navbar-brand img {
                height: 40px;
            }

            .nav-link {
                margin-left: 15px;
            }
        }

        /* Small Tablets and Large Phones */
        @media (max-width: 768px) {
            .hero-section {
                padding: 50px 0 60px;
            }

            .hero-content {
                padding-top: 100px;
            }

            .hero-planet {
                max-width: 140px;
                margin-bottom: 1.5rem;
            }

            .hero-title {
                font-size: 2.3rem;
                line-height: 1.2;
                padding: 0 10px;
            }

            .hero-subtitle {
                font-size: 0.98rem;
                padding: 0 20px;
                line-height: 1.6;
                margin-bottom: 1.5rem;
            }

            .d-flex.justify-content-center.gap-3 {
                flex-direction: column;
                gap: 0.75rem !important;
                padding: 0 20px;
            }

            .btn-neon {
                width: 100%;
                max-width: 300px;
                padding: 12px 25px;
                font-size: 0.9rem;
            }

            .overview-carousel .carousel-item img {
                height: 250px;
            }

            .section-padding {
                padding: 60px 0;
            }

            .section-title {
                font-size: 2rem;
                margin-bottom: 1.5rem;
            }

            .about-text p {
                font-size: 1rem;
            }

            .glass-card {
                padding: 1.25rem;
                margin-bottom: 1rem;
            }

            .card-icon {
                font-size: 2.5rem;
            }

            .product-img {
                height: 180px;
            }

            .navbar {
                padding: 0.75rem 0;
            }

            .navbar-brand img {
                height: 35px;
            }

            .nav-link {
                margin-left: 0;
                padding: 0.5rem 0;
            }

            footer {
                padding: 2rem 0;
            }

            .partner-logo {
                height: 60px;
                margin: 0 25px;
            }
        }

        /* Mobile Phones */
        @media (max-width: 576px) {
            .hero-section {
                padding: 40px 0 50px;
            }

            .hero-content {
                padding-top: 90px;
            }

            .hero-planet {
                max-width: 120px;
                margin-bottom: 1.25rem;
            }

            .hero-title {
                font-size: 1.5rem;
                line-height: 1.3;
                padding: 0 20px;
                margin-bottom: 0.75rem;
                word-wrap: break-word;
                overflow-wrap: break-word;
                hyphens: auto;
            }

            .hero-subtitle {
                font-size: 0.875rem;
                padding: 0 20px;
                line-height: 1.5;
                margin-bottom: 1.25rem;
                word-wrap: break-word;
                overflow-wrap: break-word;
            }

            .d-flex.justify-content-center.gap-3 {
                flex-direction: column;
                gap: 0.75rem !important;
                padding: 0 15px;
            }

            .btn-neon {
                width: 100%;
                max-width: 100%;
                padding: 10px 20px;
                font-size: 0.85rem;
            }

            .overview-carousel .carousel-item img {
                height: 200px;
            }

            .section-padding {
                padding: 50px 0;
            }

            .section-title {
                font-size: 1.75rem;
                margin-bottom: 1.25rem;
            }

            .about-text p {
                font-size: 0.95rem;
                line-height: 1.7;
            }

            .glass-card {
                padding: 1rem;
                margin-bottom: 1rem;
            }

            .glass-card h3,
            .glass-card h4 {
                font-size: 1.25rem;
            }

            .card-icon {
                font-size: 2rem;
                margin-bottom: 1rem;
            }

            .product-img {
                height: 150px;
            }

            .navbar {
                padding: 0.5rem 0;
            }

            .navbar-brand img {
                height: 30px;
            }

            .container {
                padding-left: 15px;
                padding-right: 15px;
            }

            footer {
                padding: 1.5rem 0;
                text-align: center;
            }

            footer .row {
                flex-direction: column;
            }

            footer .col-md-6 {
                margin-bottom: 1rem;
            }

            .partner-logo {
                height: 50px;
                margin: 0 20px;
            }

            .social-link {
                width: 35px;
                height: 35px;
                margin: 0 3px;
            }

            #rocket-top {
                width: 60px;
                height: 60px;
                bottom: 20px;
                right: 20px;
            }
        }

        /* Extra Small Phones */
        @media (max-width: 480px) {
            .hero-section {
                padding: 30px 0 40px;
            }

            .hero-content {
                padding-top: 80px;
            }

            .hero-planet {
                max-width: 100px;
                margin-bottom: 1rem;
            }

            .hero-title {
                font-size: 1.3rem;
                line-height: 1.3;
                padding: 0 15px;
                margin-bottom: 0.75rem;
                word-wrap: break-word;
                overflow-wrap: break-word;
                hyphens: auto;
            }

            .hero-subtitle {
                font-size: 0.8rem;
                padding: 0 15px;
                line-height: 1.5;
                margin-bottom: 1rem;
                word-wrap: break-word;
                overflow-wrap: break-word;
            }

            .d-flex.justify-content-center.gap-3 {
                flex-direction: column;
                gap: 0.5rem !important;
                padding: 0 10px;
                align-items: center;
            }

            .btn-neon {
                width: 100%;
                max-width: 280px;
                padding: 10px 15px;
                font-size: 0.8rem;
            }

            .overview-carousel .carousel-item img {
                height: 180px;
            }

            .section-padding {
                padding: 40px 0;
            }

            .section-title {
                font-size: 1.5rem;
                margin-bottom: 1rem;
            }

            .about-text p {
                font-size: 0.9rem;
            }

            .glass-card {
                padding: 0.875rem;
            }

            .glass-card h3,
            .glass-card h4 {
                font-size: 1.1rem;
            }

            .card-icon {
                font-size: 1.75rem;
            }

            .product-img {
                height: 130px;
            }

            .navbar-brand img {
                height: 28px;
            }

            .partner-logo {
                height: 40px;
                margin: 0 15px;
            }

            #rocket-top {
                width: 50px;
                height: 50px;
                bottom: 15px;
                right: 15px;
            }
        }

        /* Very Small Phones (iPhone SE, small Android) */
        @media (max-width: 360px) {
            .hero-section {
                padding: 25px 0 35px;
            }

            .hero-content {
                padding-top: 70px;
            }

            .hero-planet {
                max-width: 90px;
                margin-bottom: 0.875rem;
            }

            .hero-title {
                font-size: 1.15rem;
                line-height: 1.3;
                padding: 0 12px;
                margin-bottom: 0.625rem;
                word-wrap: break-word;
                overflow-wrap: break-word;
                hyphens: auto;
            }

            .hero-subtitle {
                font-size: 0.75rem;
                padding: 0 12px;
                line-height: 1.5;
                margin-bottom: 0.875rem;
                word-wrap: break-word;
                overflow-wrap: break-word;
            }

            .d-flex.justify-content-center.gap-3 {
                padding: 0 12px;
            }

            .btn-neon {
                padding: 9px 12px;
                font-size: 0.75rem;
            }
        }

        .orbiting-satellite {
            position: absolute;
            width: 70px;
            opacity: 0.8;
            filter: drop-shadow(0 0 8px rgba(212, 18, 161, 0.6));
            pointer-events: none;
            animation: orbitOne 28s linear infinite;
        }

        .orbit-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
        }

        .orbiting-satellite img {
            width: 100%;
            height: auto;
        }

        .orbit-two {
            animation: orbitTwo 36s linear infinite;
            width: 55px;
            opacity: 0.65;
        }

        @keyframes orbitOne {
            0% {
                transform: rotate(0deg) translateX(260px) rotate(0deg);
            }

            50% {
                transform: rotate(180deg) translateX(260px) rotate(-180deg);
            }

            100% {
                transform: rotate(360deg) translateX(260px) rotate(-360deg);
            }
        }

        @keyframes orbitTwo {
            0% {
                transform: rotate(0deg) translateX(-200px) rotate(0deg);
            }

            50% {
                transform: rotate(180deg) translateX(-200px) rotate(-180deg);
            }

            100% {
                transform: rotate(360deg) translateX(-200px) rotate(-360deg);
            }
        }

        #starfield {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
            padding-top: clamp(100px, 14vh, 190px);
            padding-left: 15px;
            padding-right: 15px;
        }

        @media (max-width: 576px) {
            .hero-content {
                padding-left: 10px;
                padding-right: 10px;
            }
        }

        @media (max-width: 360px) {
            .hero-content {
                padding-left: 8px;
                padding-right: 8px;
            }
        }

        .hero-planet {
            max-width: 200px;
            margin-top: 0;
            margin-bottom: 2rem;
            animation: floatSat 6s ease-in-out infinite;
            filter: drop-shadow(0 0 20px rgba(0, 0, 0, 0.8));
        }

        @keyframes floatSat {
            0% {
                transform: translateY(0px) rotate(0deg);
            }

            50% {
                transform: translateY(-20px) rotate(5deg);
            }

            100% {
                transform: translateY(0px) rotate(0deg);
            }
        }

        .hero-title {
            font-size: 3.5rem;
            font-weight: 900;
            text-transform: uppercase;
            background: linear-gradient(to right, #fff, var(--primary));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            color: transparent;
            margin-bottom: 1rem;
            animation: fadeInDown 1s ease-out;
            position: relative;
            overflow: hidden;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
        }

        .hero-subtitle {
            font-size: 1.25rem;
            color: var(--text-bright);
            /* Brighter text */
            max-width: 700px;
            margin: 0 auto 2rem auto;
            animation: fadeInUp 1s ease-out 0.5s backwards;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .btn-neon {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
            padding: 12px 35px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(212, 18, 161, 0.2);
            position: relative;
            overflow: hidden;
            text-decoration: none;
            display: inline-block;
        }

        .btn-neon:hover {
            background: var(--primary);
            color: #fff;
            box-shadow: 0 0 25px var(--primary-glow);
            transform: translateY(-3px);
        }

        /* --- Sections General --- */
        .section-padding {
            padding: 100px 0;
        }

        .section-title {
            margin-bottom: 3rem;
            position: relative;
            display: inline-block;
            overflow: hidden;
        }

        .hero-title::before,
        .section-title::before,
        .glass-card h3::before,
        .glass-card h4::before {
            content: '';
            position: absolute;
            top: 0;
            left: -150%;
            width: 80%;
            height: 100%;
            background: linear-gradient(120deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmerSweep 6s linear infinite;
            z-index: 1;
        }

        .hero-title,
        .glass-card h3,
        .glass-card h4,
        .section-title {
            position: relative;
            overflow: hidden;
        }

        @keyframes shimmerSweep {
            0% {
                left: -150%;
            }

            100% {
                left: 150%;
            }
        }


        .section-title::after {
            content: '';
            display: block;
            width: 60px;
            height: 4px;
            background: var(--primary);
            margin-top: 10px;
            box-shadow: 0 0 10px var(--primary);
        }

        /* --- About / Overview --- */
        .about-text p {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--text-bright);
            /* Brighter text */
        }

        /* Responsive overview section */
        @media (max-width: 768px) {
            .about-text p {
                font-size: 1rem;
                line-height: 1.7;
            }

            .about-text h3 {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 576px) {
            .about-text p {
                font-size: 0.95rem;
                line-height: 1.6;
            }

            .about-text h3 {
                font-size: 1.3rem;
            }
        }

        .about-highlight {
            color: var(--primary);
            font-weight: 600;
        }

        /* --- Cards (Products & Services) --- */
        .glass-card {
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 2rem;
            height: 100%;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .glass-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, transparent 0%, rgba(212, 18, 161, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: -1;
        }

        .glass-card:hover {
            transform: translateY(-10px);
            border-color: var(--primary);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5), 0 0 20px rgba(212, 18, 161, 0.2);
        }

        .glass-card:hover::before {
            opacity: 1;
        }

        .card-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1.5rem;
            transition: transform 0.4s;
        }

        .glass-card:hover .card-icon {
            transform: scale(1.1) rotate(5deg);
            text-shadow: 0 0 15px var(--primary);
        }

        .product-img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            filter: grayscale(80%);
            transition: filter 0.4s;
        }

        .glass-card:hover .product-img {
            filter: grayscale(0%);
        }

        /* --- Partner Marquee --- */
        .partners-section {
            background: linear-gradient(to bottom, var(--dark-bg), #0f0f0f, var(--dark-bg));
        }

        .marquee-container {
            overflow: hidden;
            white-space: nowrap;
            position: relative;
        }

        .marquee-content {
            display: inline-flex;
            animation: scroll 30s linear infinite;
        }

        .marquee-content:hover {
            animation-play-state: paused;
        }

        .partner-logo {
            height: 80px;
            width: auto;
            margin: 0 40px;
            opacity: 0.7;
            filter: grayscale(100%) brightness(1.5);
            /* Brightness increased for dark bg */
            transition: all 0.3s;
        }

        .partner-logo:hover {
            opacity: 1;
            filter: grayscale(0%) brightness(1);
            transform: scale(1.1);
        }

        @keyframes scroll {
            0% {
                transform: translateX(0);
            }

            100% {
                transform: translateX(-50%);
            }
        }

        /* --- Footer --- */
        footer {
            background: #000;
            border-top: 1px solid rgba(212, 18, 161, 0.3);
            padding: 3rem 0;
        }

        .social-link {
            width: 40px;
            height: 40px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            color: white;
            margin: 0 5px;
            transition: all 0.3s;
            overflow: hidden;
        }

        .social-link img {
            width: 20px;
            height: 20px;
            filter: invert(1);
        }

        .social-link:hover {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
            box-shadow: 0 0 15px var(--primary-glow);
        }

        /* --- Rocket Scroll Top --- */
        #rocket-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 9999;
            width: 80px;
            /* Increased size */
            height: 80px;
            /* Increased size */
            background: transparent;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            border: none;
            /* Disable default text selection on long press */
            -webkit-user-select: none;
            user-select: none;
        }

        #rocket-top.show {
            opacity: 1;
            visibility: visible;
        }

        #rocket-top:active {
            transform: scale(0.95);
        }

        /* Tooltip Text */
        #rocket-tooltip {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s;
            font-family: 'Orbitron', sans-serif;
            pointer-events: none;
        }

        #rocket-top:hover #rocket-tooltip {
            opacity: 1;
            visibility: visible;
        }

        /* Rocket GIF Styling */
        #rocket-top img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            display: block;
            filter: drop-shadow(0 0 5px rgba(212, 18, 161, 0.8));
        }

        /* The Launch Animation (Scroll to Top) */
        @keyframes flyUp {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }

            20% {
                transform: translateY(20px) scale(0.9);
            }

            100% {
                transform: translateY(-120vh) scale(0.5);
                opacity: 0;
            }
        }

        #rocket-top.launching {
            animation: flyUp 1s ease-in-out forwards;
            pointer-events: none;
        }

        /* --- Easter Egg Modal --- */
        .easter-egg-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            display: none;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.5s;
            backdrop-filter: blur(10px);
        }

        .easter-egg-overlay.active {
            display: flex;
            opacity: 1;
        }

        .easter-egg-content {
            background: rgba(20, 20, 20, 0.95);
            border: 2px solid var(--primary);
            padding: 2rem;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            position: relative;
            box-shadow: 0 0 50px var(--primary-glow);
            transform: scale(0.8);
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .easter-egg-overlay.active .easter-egg-content {
            transform: scale(1);
        }

        .char-gif {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 50%;
            margin-bottom: 1rem;
            border: 3px solid var(--primary);
            background: #000;
        }

        .close-egg {
            position: absolute;
            top: 10px;
            right: 15px;
            color: #fff;
            font-size: 2rem;
            cursor: pointer;
            line-height: 1;
        }

        .close-egg:hover {
            color: var(--primary);
        }

        /* Responsive news section */
        @media (max-width: 768px) {
            .glass-card.p-0 img {
                height: 180px;
                object-fit: cover;
            }

            .glass-card.p-0 .p-3 h5 {
                font-size: 1.1rem;
            }

            .glass-card.p-0 .p-3 p {
                font-size: 0.9rem;
            }
        }

        @media (max-width: 576px) {
            .glass-card.p-0 img {
                height: 150px;
            }

            .glass-card.p-0 .p-3 {
                padding: 1rem !important;
            }

            .glass-card.p-0 .p-3 h5 {
                font-size: 1rem;
            }

            .glass-card.p-0 .p-3 p {
                font-size: 0.85rem;
            }
        }
    </style>
</head>

<body>

    <!-- Preloader -->
    <div id="preloader"
        style="position:fixed; top:0; left:0; width:100%; height:100%; background:#050505; z-index:9999; display:flex; justify-content:center; align-items:center;">
        <div class="spinner-border text-primary" role="status"
            style="width: 3rem; height: 3rem; color: #d412a1 !important;">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">
                <!-- LOGO PATH UPDATED -->
                <img src="dist/custom/images/logo.png" class="logogok" alt="Spacelabs Logo" />
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="fa fa-bars" style="color: white; font-size: 1.5rem;"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link active" href="#home">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="#overview">Overview</a></li>
                    <li class="nav-item"><a class="nav-link" href="#products">Products</a></li>
                    <li class="nav-item"><a class="nav-link" href="#services">Services</a></li>
                    <li class="nav-item"><a class="nav-link" href="#news">News</a></li>
                    <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero-section">
        <canvas id="starfield"></canvas>
        <div class="aurora-band band-1" aria-hidden="true"></div>
        <div class="aurora-band band-2" aria-hidden="true"></div>
        <div class="orbit-container" aria-hidden="true">
            <div class="orbiting-satellite orbit-one">
                <img src="dist/custom/images/sat.png" alt="Orbiting satellite">
            </div>
            <div class="orbiting-satellite orbit-two">
                <img src="img/astronaut.png" alt="Orbiting probe">
            </div>
        </div>
        <div class="container hero-content">
            <div data-aos="zoom-in" data-aos-duration="1200">
                <!-- SAT.PNG PATH UPDATED & VISIBLE -->
                <img src="dist/custom/images/sat.png" class="hero-planet" alt="Satellite" />

                <h1 class="hero-title">Innovation in Space</h1>
                <p class="hero-subtitle">
                    Empowering space and defence missions with advanced technology, simulation, software, and services.
                    The ultimate solution for your space needs.
                </p>
                <div class="d-flex justify-content-center gap-3">
                    <a href="#overview" class="btn btn-neon">Explore Mission</a>
                    <a href="contact.html" class="btn btn-neon" style="filter: hue-rotate(45deg);">Get in Touch</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Overview Section -->
    <section id="overview" class="section-padding">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6" data-aos="fade-right">
                    <h2 class="section-title">Overview</h2>
                    <h3 class="text-white mb-4">Cutting-edge tools & technologies for your space mission</h3>
                    <div class="about-text">
                        <p>SpaceLabs is committed to providing cutting-edge technology to the aerospace industry,
                            helping customers in the digital transformation of simulation and trajectory optimization.
                        </p>
                        <p><span class="about-highlight">Software Based Simulation:</span> From vehicle configuration
                            design to subsystem performance assessment, our high-granularity test beds allow for
                            rigorous validation.</p>
                        <p><span class="about-highlight">Simulation Test Bed:</span> Configurable 6-DOF simulation beds
                            with plug-and-play features for standalone and integrated testing, bridging the gap between
                            hardware and flight software.</p>
                    </div>
                    <a href="overview.html" class="btn btn-neon mt-3">Read More</a>
                </div>
                <div class="col-lg-6 mt-5 mt-lg-0" data-aos="fade-left">
                    <div id="overviewCarousel" class="carousel slide overview-carousel" data-bs-ride="carousel"
                        data-bs-interval="4000">
                        <div class="carousel-indicators">
                            <button type="button" data-bs-target="#overviewCarousel" data-bs-slide-to="0" class="active"
                                aria-current="true" aria-label="Slide 1"></button>
                            <button type="button" data-bs-target="#overviewCarousel" data-bs-slide-to="1"
                                aria-label="Slide 2"></button>
                            <button type="button" data-bs-target="#overviewCarousel" data-bs-slide-to="2"
                                aria-label="Slide 3"></button>
                            <button type="button" data-bs-target="#overviewCarousel" data-bs-slide-to="3"
                                aria-label="Slide 4"></button>
                            <button type="button" data-bs-target="#overviewCarousel" data-bs-slide-to="4"
                                aria-label="Slide 5"></button>
                            <button type="button" data-bs-target="#overviewCarousel" data-bs-slide-to="5"
                                aria-label="Slide 6"></button>
                        </div>
                        <div class="carousel-inner">
                            <div class="carousel-item active">
                                <img src="img/unsp1.jpg" class="d-block w-100"
                                    alt="Trajectory optimization and optimizers for aerospace applications">
                                <div class="carousel-caption">
                                    <h3>Optimizers</h3>
                                    <p>We optimize trajectory with a spectrum of advanced optimizers.</p>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <img src="img/imx3.jpg" class="d-block w-100"
                                    alt="High granularity vehicle simulation technology">
                                <div class="carousel-caption">
                                    <h3>Simulation</h3>
                                    <p>Simulate aerospace vehicles with highest granularity.</p>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <img src="img/imx1.jpg" class="d-block w-100"
                                    alt="Closed loop simulation with mathematical models and flight software">
                                <div class="carousel-caption">
                                    <h3>Closed-loop Simulation</h3>
                                    <p>Integrate mathematical models, flight software, and hardware.</p>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <img src="img/imx4.jpg" class="d-block w-100"
                                    alt="Navigation, Guidance and Control system development for aerospace vehicles">
                                <div class="carousel-caption">
                                    <h3>System Development</h3>
                                    <p>We build Navigation, Guidance & Control brains for aerospace vehicles.</p>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <img src="img/imx1.jpg" class="d-block w-100"
                                    alt="AI/ML enabled software simulator with hardware integration capabilities">
                                <div class="carousel-caption">
                                    <h3>Simulator</h3>
                                    <p>AI/ML-ready simulators with integration for tools, data, and hardware.</p>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <img src="img/imx4.jpg" class="d-block w-100"
                                    alt="Complete space mission solutions and aerospace technology">
                                <div class="carousel-caption">
                                    <h3>Mission Ready</h3>
                                    <p>The ultimate solution for conquering the sky and beyond.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section id="products" class="section-padding" style="background: rgba(255,255,255,0.02);">
        <div class="container">
            <div class="text-center mb-5" data-aos="fade-up">
                <h2 class="section-title">Our Products</h2>
                <!-- UPDATED TEXT COLOR TO be more visible (text-bright/white) -->
                <p class="text-white mx-auto" style="max-width: 600px; opacity: 0.9;">
                    Designed for aerospace and defence sectors where perfection and precision are primary needs. Simple
                    design, user-friendly features, and quality outputs.
                </p>
                <!-- BROCHURE PATH MAINTAINED -->
                <a href="assets/spacelabs-services-brochure.pdf" target="_blank"
                    class="btn btn-sm btn-outline-light mt-3">
                    <i class="fas fa-file-pdf me-2"></i> Download Brochure
                </a>
            </div>

            <div class="row g-4">
                <!-- Product 1: ASTRA -->
                <div class="col-lg-4 col-md-6" data-aos="flip-up" data-aos-delay="100">
                    <div class="glass-card">
                        <!-- IMAGE PATH UPDATED -->
                        <img src="img/unsplash-photo-1.jpg" class="product-img" alt="ASTRA">
                        <h3 class="text-white">ASTRA</h3>
                        <p class="text-primary small mb-3">AeroSpace TRAjectory optimizer</p>
                        <p class="text-white small">Optimizing trajectories with a spectrum of advanced mathematical
                            optimizers for maximum mission efficiency.</p>
                        <a href="astra.html" class="btn btn-neon btn-sm w-100 mt-3">View Details</a>
                    </div>
                </div>

                <!-- Product 2: SARAS -->
                <div class="col-lg-4 col-md-6" data-aos="flip-up" data-aos-delay="200">
                    <div class="glass-card">
                        <!-- IMAGE PATH UPDATED -->
                        <img src="img/unsplash-photo-2.jpg" class="product-img" alt="SARAS">
                        <h3 class="text-white">SARAS</h3>
                        <p class="text-primary small mb-3">Aerospace Simulator - 6 DOF</p>
                        <p class="text-white small">High granularity vehicle simulation technology allowing for precise
                            6-Degrees-of-Freedom analysis.</p>
                        <a href="saras6.html" class="btn btn-neon btn-sm w-100 mt-3">View Details</a>
                    </div>
                </div>

                <!-- Product 3: DRUV -->
                <div class="col-lg-4 col-md-6" data-aos="flip-up" data-aos-delay="300">
                    <div class="glass-card">
                        <!-- IMAGE PATH UPDATED -->
                        <img src="img/druv1.jpg" class="product-img" alt="Druv">
                        <h3 class="text-white">Druv</h3>
                        <p class="text-primary small mb-3">Orbital Studies</p>
                        <p class="text-white small">Advanced Simulator and Optimizer specifically designed for complex
                            Orbital Studies and mission planning.</p>
                        <a href="#" class="btn btn-neon btn-sm w-100 mt-3">View Details</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section id="services" class="section-padding">
        <div class="container">
            <div class="text-center mb-5" data-aos="fade-up">
                <h2 class="section-title">Our Services</h2>
                <!-- UPDATED TEXT COLOR -->
                <p class="text-white">Comprehensive solutions for aerospace and defence missions.</p>
            </div>

            <div class="row g-4 justify-content-center">
                <!-- Service 1 -->
                <div class="col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="100">
                    <a href="mission-design.html" class="text-decoration-none">
                        <div class="glass-card text-center">
                            <i class="fas fa-flag card-icon"></i>
                            <h4 class="text-white">Mission Design</h4>
                            <!-- UPDATED TEXT COLOR to lighter white -->
                            <p class="text-white small mt-2" style="opacity: 0.8;">End-to-end mission planning and
                                trajectory design.</p>
                        </div>
                    </a>
                </div>

                <!-- Service 2 -->
                <div class="col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="200">
                    <a href="subsystem-development.html" class="text-decoration-none">
                        <div class="glass-card text-center">
                            <i class="fas fa-cogs card-icon"></i>
                            <h4 class="text-white">System Development</h4>
                            <p class="text-white small mt-2" style="opacity: 0.8;">NGC (Navigation, Guidance & Control)
                                system architecture.
                            </p>
                        </div>
                    </a>
                </div>

                <!-- Service 3 -->
                <div class="col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="300">
                    <a href="algorithm-development.html" class="text-decoration-none">
                        <div class="glass-card text-center">
                            <i class="fas fa-square-root-alt card-icon"></i>
                            <h4 class="text-white">Math Models</h4>
                            <p class="text-white small mt-2" style="opacity: 0.8;">Precise mathematical model
                                development for simulations.</p>
                        </div>
                    </a>
                </div>

                <!-- Service 4 -->
                <div class="col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="400">
                    <a href="flight-software-development.html" class="text-decoration-none">
                        <div class="glass-card text-center">
                            <i class="fas fa-code card-icon"></i>
                            <h4 class="text-white">Flight Software</h4>
                            <p class="text-white small mt-2" style="opacity: 0.8;">Reliable onboard flight software
                                development.</p>
                        </div>
                    </a>
                </div>

                <!-- Service 5: Simulation (ADDED) -->
                <div class="col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="500">
                    <a href="simulation.html" class="text-decoration-none">
                        <div class="glass-card text-center">
                            <i class="fas fa-laptop-code card-icon"></i>
                            <h4 class="text-white">Simulation</h4>
                            <p class="text-white small mt-2" style="opacity: 0.8;">Real-time 6-DOF simulation and
                                hardware-in-loop testing.</p>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Partners Section (Marquee) -->
    <section class="partners-section py-5">
        <div class="container mb-4">
            <h4 class="text-center text-white opacity-50 font-orbitron">TRUSTED PARTNERS</h4>
        </div>
        <div class="marquee-container">
            <div class="marquee-content">
                <!-- PATHS UPDATED TO ORIGINAL IMAGES -->
                <img src="img/IIT_Madras_Logo.svg.png" class="partner-logo" alt="IIT Madras">
                <img src="img/L&T.png" class="partner-logo" alt="L&T">
                <img src="img/Cosmic-1.png" class="partner-logo" alt="Cosmic">
                <img src="img/MTAR-Logo.webp" class="partner-logo" alt="MTAR">
                <img src="img/SKYROOT.png" class="partner-logo" alt="Skyroot">
                <!-- Duplicate Set for looping -->
                <img src="img/IIT_Madras_Logo.svg.png" class="partner-logo" alt="IIT Madras">
                <img src="img/L&T.png" class="partner-logo" alt="L&T">
                <img src="img/Cosmic-1.png" class="partner-logo" alt="Cosmic">
                <img src="img/MTAR-Logo.webp" class="partner-logo" alt="MTAR">
                <img src="img/SKYROOT.png" class="partner-logo" alt="Skyroot">
            </div>
        </div>
    </section>

    <!-- News Section -->
    <section id="news" class="section-padding">
        <div class="container">
            <h2 class="section-title text-center w-100">SpaceLabs in News</h2>
            <div class="row g-4 mt-4">
                <div class="col-md-4" data-aos="fade-up">
                    <a href="https://timesofindia.indiatimes.com/city/thiruvananthapuram/space-startup-launches-astra/articleshow/92734704.cms"
                        target="_blank" class="text-decoration-none">
                        <div class="glass-card p-0">
                            <!-- IMAGE PATH UPDATED -->
                            <img src="img/n1.jpg" class="w-100 rounded-top" alt="News">
                            <div class="p-3">
                                <h5 class="text-white">Space startup launches ASTRA</h5>
                                <p class="text-primary small">Times of India</p>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-md-4" data-aos="fade-up" data-aos-delay="100">
                    <a href="https://keralatechnology.com/blog/all-women-team-ready-for-lift-off" target="_blank"
                        class="text-decoration-none">
                        <div class="glass-card p-0">
                            <!-- IMAGE PATH UPDATED -->
                            <img src="img/n2.jpg" class="w-100 rounded-top" alt="News">
                            <div class="p-3">
                                <h5 class="text-white">All women team ready for lift off</h5>
                                <p class="text-primary small">Kerala Technology</p>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-md-4" data-aos="fade-up" data-aos-delay="200">
                    <a href="#" class="text-decoration-none">
                        <div class="glass-card p-0">
                            <!-- IMAGE PATH UPDATED -->
                            <img src="img/n3.jpg" class="w-100 rounded-top" alt="News">
                            <div class="p-3">
                                <h5 class="text-white">Latest Developments</h5>
                                <p class="text-primary small">SpaceLabs Update</p>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                    <p class="mb-0 text-muted">&copy; <span id="current-year"></span> SpaceLabs. All rights reserved.
                    </p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <a href="https://www.linkedin.com/company/thespacelabs" target="_blank" class="social-link">
                        <!-- LINKEDIN ICON PATH RESTORED -->
                        <img src="icon/linkedin.png" alt="LinkedIn">
                    </a>
                    <!-- kept font awesome for generic icons where no image existed -->
                    <a href="#" class="social-link">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" class="social-link">
                        <i class="fas fa-envelope"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Rocket Scroll Top (With Image) -->
    <div id="rocket-top" title="Back to Top">
        <span id="rocket-tooltip">Go to Top</span>
        <!-- Using your provided GIF name -->
        <img src="img/rocket.gif" alt="Rocket Launch">
    </div>

    <!-- Easter Egg Modal -->
    <div id="easter-egg-modal" class="easter-egg-overlay">
        <div class="easter-egg-content">
            <span class="close-egg">&times;</span>
            <!-- Placeholder Character GIF -->
            <img src="https://media.giphy.com/media/l3vR16pONsV8cKkWk/giphy.gif" class="char-gif" alt="Space Character">
            <h4 class="text-white mb-3">Secret Found! </h4>
            <p class="text-white mb-4">Want to know who created this and me?</p>
            <a href="https://www.linkedin.com/in/ananthudev/" target="_blank" class="btn btn-neon">Click Here</a>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <script>
        // Init AOS Animation
        AOS.init({
            once: true,
            offset: 100,
            duration: 800
        });

        // Set Current Year
        document.getElementById('current-year').textContent = new Date().getFullYear();

        // Remove Preloader
        window.addEventListener('load', () => {
            document.getElementById('preloader').style.display = 'none';
        });

        // --- ROCKET SCROLL & EASTER EGG LOGIC ---
        const rocketBtn = document.getElementById('rocket-top');
        const modal = document.getElementById('easter-egg-modal');
        const closeModal = document.querySelector('.close-egg');

        let pressTimer;
        let isLongPress = false;

        // Show/Hide Rocket on Scroll
        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                rocketBtn.classList.add('show');
                if (!rocketBtn.classList.contains('launching')) {
                    rocketBtn.style.opacity = '1';
                    rocketBtn.style.visibility = 'visible';
                }
            } else {
                rocketBtn.classList.remove('show');
            }
        });

        // --- Long Press Detection Logic ---

        // Mouse Down / Touch Start -> Start Timer
        const startPress = (e) => {
            isLongPress = false; // Reset flag
            pressTimer = setTimeout(() => {
                isLongPress = true;
                // Trigger Easter Egg
                modal.classList.add('active');
            }, 6000); // 6 seconds wait
        };

        // Mouse Up / Leave / Touch End -> Clear Timer
        const cancelPress = (e) => {
            clearTimeout(pressTimer);
        };

        // Attach Events for Long Press
        rocketBtn.addEventListener('mousedown', startPress);
        rocketBtn.addEventListener('touchstart', startPress);

        rocketBtn.addEventListener('mouseup', cancelPress);
        rocketBtn.addEventListener('mouseleave', cancelPress);
        rocketBtn.addEventListener('touchend', cancelPress);

        // Click Handler (Launch Logic)
        rocketBtn.addEventListener('click', (e) => {
            e.preventDefault();

            // If it was a long press (Easter Egg opened), do NOT launch rocket
            if (isLongPress) {
                isLongPress = false; // Reset for next time
                return;
            }

            // Normal Click Behavior -> Launch Rocket
            rocketBtn.classList.add('launching');

            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });

            setTimeout(() => {
                rocketBtn.classList.remove('launching');
                rocketBtn.classList.remove('show');
            }, 1000);
        });

        // Close Modal Logic
        closeModal.addEventListener('click', () => {
            modal.classList.remove('active');
        });

        // Close modal when clicking outside box
        window.addEventListener('click', (e) => {
            if (e.target == modal) {
                modal.classList.remove('active');
            }
        });

        // --- STARFIELD ANIMATION SCRIPT ---
        const canvas = document.getElementById('starfield');
        const ctx = canvas.getContext('2d');

        let width, height;
        let stars = [];
        const numStars = 800;
        const parallaxConfigs = [
            { multiplier: 0.5, depth: 0.7, speed: 0.8 },
            { multiplier: 1, depth: 1, speed: 1 },
            { multiplier: 0.4, depth: 1.4, speed: 1.2 }
        ];
        const baseSpeed = 0.1;
        let currentSpeed = baseSpeed;
        let mouseX = 0;
        let mouseY = 0;
        let mouseActive = false;
        let particles = []; // For click burst effect
        let mouseTrail = []; // For star trails on mouse movement
        let lastMouseX = 0;
        let lastMouseY = 0;
        let mouseVelocity = 0;
        let time = 0; // For pulsing animation
        let constellations = []; // For constellation drawing
        let isDrawing = false;
        let drawStartX = 0;
        let drawStartY = 0;
        let currentConstellation = null;
        let warpSpeed = false; // Warp speed effect
        let warpIntensity = 0; // Warp intensity (0-1)
        let warpDuration = 0; // Warp duration counter
        let lastClickTime = 0; // For double-click detection
        let meteors = []; // For meteor shower
        let comets = []; // For rare comet events
        let lastScrollY = 0;
        let scrollDelta = 0;
        let meteorCooldown = 0; // Prevent too many meteors
        let nebulaClouds = []; // For nebula clouds
        let cometTimer = 0;
        let cometInterval = 600 + Math.random() * 600; // ~10s default
        let magneticLines = [];
        let blackHoleActive = false;
        let blackHoleStrength = 0;
        let blackHoleCenter = { x: 0, y: 0 };
        let blackHoleDuration = 0;
        let blackHoleTimer = null;
        let blackHoleSpiralRotation = 0;
        const BLACK_HOLE_MAX_DURATION = 240;
        let spaceDust = [];
        const DUST_COUNT = 120;

        // Resize Canvas
        function resize() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
        }

        // Track mouse position with velocity for trails
        canvas.addEventListener('mousemove', (e) => {
            const newMouseX = e.clientX - width / 2;
            const newMouseY = e.clientY - height / 2;

            // Calculate velocity for trail intensity
            const dx = newMouseX - lastMouseX;
            const dy = newMouseY - lastMouseY;
            mouseVelocity = Math.sqrt(dx * dx + dy * dy);

            // Add to trail if moving fast enough
            if (mouseVelocity > 2) {
                mouseTrail.push({
                    x: e.clientX,
                    y: e.clientY,
                    life: 1.0,
                    intensity: Math.min(mouseVelocity / 10, 1)
                });
                // Keep trail length manageable
                if (mouseTrail.length > 20) {
                    mouseTrail.shift();
                }
            }

            // Magnetic field lines near cursor (subtle arcs)
            if (mouseVelocity > 1) {
                const fieldLines = 1 + Math.floor(Math.random() * 2);
                for (let i = 0; i < fieldLines; i++) {
                    magneticLines.push({
                        x: e.clientX,
                        y: e.clientY,
                        radius: 40 + Math.random() * 80,
                        startAngle: Math.random() * Math.PI * 2,
                        span: (Math.PI / 2) + Math.random() * (Math.PI / 2),
                        direction: Math.random() > 0.5,
                        thickness: 0.5 + Math.random() * 1.5,
                        life: 1.0,
                        decay: 0.04 + Math.random() * 0.03
                    });
                }
                if (magneticLines.length > 60) {
                    magneticLines.splice(0, magneticLines.length - 60);
                }
            }

            // Constellation drawing - track points while dragging
            if (isDrawing && currentConstellation) {
                const currentX = e.clientX;
                const currentY = e.clientY;
                const lastPoint = currentConstellation.points[currentConstellation.points.length - 1];
                const distance = Math.sqrt(
                    Math.pow(currentX - lastPoint.x, 2) +
                    Math.pow(currentY - lastPoint.y, 2)
                );

                // Add point if moved enough (prevents too many points)
                if (distance > 15) {
                    currentConstellation.points.push({ x: currentX, y: currentY });
                }
            }

            mouseX = newMouseX;
            mouseY = newMouseY;
            lastMouseX = newMouseX;
            lastMouseY = newMouseY;
            mouseActive = true;
        });

        canvas.addEventListener('mouseleave', () => {
            clearBlackHoleTimer();
            mouseActive = false;
            mouseVelocity = 0;
        });

        // Touch support for mobile
        let touchStartX = 0;
        let touchStartY = 0;
        let touchActive = false;

        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            touchStartX = touch.clientX;
            touchStartY = touch.clientY;
            mouseX = touch.clientX - width / 2;
            mouseY = touch.clientY - height / 2;
            touchActive = true;
            mouseActive = true;
        });

        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            const newMouseX = touch.clientX - width / 2;
            const newMouseY = touch.clientY - height / 2;

            // Calculate swipe velocity
            const dx = newMouseX - lastMouseX;
            const dy = newMouseY - lastMouseY;
            mouseVelocity = Math.sqrt(dx * dx + dy * dy);

            // Create star stream effect on swipe
            if (mouseVelocity > 5) {
                for (let i = 0; i < 3; i++) {
                    mouseTrail.push({
                        x: touch.clientX + (Math.random() - 0.5) * 20,
                        y: touch.clientY + (Math.random() - 0.5) * 20,
                        life: 0.8,
                        intensity: Math.min(mouseVelocity / 15, 1)
                    });
                }
                if (mouseTrail.length > 30) {
                    mouseTrail.shift();
                }
            }

            mouseX = newMouseX;
            mouseY = newMouseY;
            lastMouseX = newMouseX;
            lastMouseY = newMouseY;
        });

        canvas.addEventListener('touchend', (e) => {
            e.preventDefault();
            touchActive = false;
            mouseActive = false;
            mouseVelocity = 0;
        });

        // Particle class for burst effect (defined early for use in click handler)
        class Particle {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.vx = (Math.random() - 0.5) * 8;
                this.vy = (Math.random() - 0.5) * 8;
                this.life = 1.0;
                this.decay = 0.02;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.vx *= 0.95;
                this.vy *= 0.95;
                this.life -= this.decay;
            }

            draw() {
                ctx.save();
                ctx.globalAlpha = this.life;
                ctx.fillStyle = "#d412a1";
                ctx.beginPath();
                ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
            }
        }

        canvas.addEventListener('contextmenu', (e) => e.preventDefault());

        // Constellation drawing - mousedown to start
        canvas.addEventListener('mousedown', (e) => {
            if (e.button === 2) {
                scheduleBlackHole(e.clientX, e.clientY);
                return;
            }
            if (e.button !== 0) {
                return;
            }
            isDrawing = true;
            drawStartX = e.clientX;
            drawStartY = e.clientY;
            currentConstellation = {
                points: [{ x: e.clientX, y: e.clientY }],
                life: 1.0,
                decay: 0.005
            };
        });

        // Mouseup to finish constellation
        canvas.addEventListener('mouseup', (e) => {
            if (e.button === 2) {
                clearBlackHoleTimer();
                return;
            }
            if (isDrawing && currentConstellation && currentConstellation.points.length > 1) {
                // Finalize constellation
                currentConstellation.points.push({ x: e.clientX, y: e.clientY });
                constellations.push(currentConstellation);
                // Keep max 5 constellations visible
                if (constellations.length > 5) {
                    constellations.shift();
                }
            }
            isDrawing = false;
            currentConstellation = null;
        });

        // Warp speed activation function
        function activateWarpSpeed() {
            warpSpeed = true;
            warpIntensity = 1.0;
            warpDuration = 0;

            // Create burst particles at center
            for (let i = 0; i < 30; i++) {
                particles.push(new Particle(width / 2, height / 2));
            }
        }

        // Click particle burst (only if not drawing)
        canvas.addEventListener('click', (e) => {
            // Only create burst if it was a quick click (not a drag)
            if (!isDrawing) {
                const currentTime = Date.now();
                const timeSinceLastClick = currentTime - lastClickTime;

                // Double-click detection (within 300ms)
                if (timeSinceLastClick < 300) {
                    activateWarpSpeed();
                    lastClickTime = 0; // Reset to prevent triple-click
                } else {
                    const clickX = e.clientX;
                    const clickY = e.clientY;
                    // Create burst particles
                    for (let i = 0; i < 15; i++) {
                        particles.push(new Particle(clickX, clickY));
                    }
                    lastClickTime = currentTime;
                }
            }
        });

        // Keyboard shortcut for warp speed (press 'W' or 'w')
        window.addEventListener('keydown', (e) => {
            if (e.key === 'w' || e.key === 'W') {
                activateWarpSpeed();
            }
            if (e.key === 'c' || e.key === 'C') {
                spawnComet(true);
            }
            if (e.key === 'b' || e.key === 'B') {
                activateBlackHole(width / 2, height / 2);
            }
        });

        // Meteor class for meteor shower
        class Meteor {
            constructor() {
                // Random starting position from top or sides
                const side = Math.floor(Math.random() * 4); // 0=top, 1=right, 2=bottom, 3=left
                if (side === 0) { // Top
                    this.x = Math.random() * width;
                    this.y = -20;
                    this.vx = (Math.random() - 0.5) * 3;
                    this.vy = 5 + Math.random() * 5;
                } else if (side === 1) { // Right
                    this.x = width + 20;
                    this.y = Math.random() * height;
                    this.vx = -(5 + Math.random() * 5);
                    this.vy = (Math.random() - 0.5) * 3;
                } else if (side === 2) { // Bottom
                    this.x = Math.random() * width;
                    this.y = height + 20;
                    this.vx = (Math.random() - 0.5) * 3;
                    this.vy = -(5 + Math.random() * 5);
                } else { // Left
                    this.x = -20;
                    this.y = Math.random() * height;
                    this.vx = 5 + Math.random() * 5;
                    this.vy = (Math.random() - 0.5) * 3;
                }

                this.length = 20 + Math.random() * 30;
                this.life = 1.0;
                this.decay = 0.01 + Math.random() * 0.02;
                this.brightness = 0.8 + Math.random() * 0.2;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.life -= this.decay;
            }

            draw(ctx) {
                if (this.life <= 0) return;

                ctx.save();
                ctx.globalAlpha = this.life * this.brightness;

                // Create gradient for meteor tail
                const gradient = ctx.createLinearGradient(
                    this.x, this.y,
                    this.x - this.vx * this.length / Math.sqrt(this.vx * this.vx + this.vy * this.vy),
                    this.y - this.vy * this.length / Math.sqrt(this.vx * this.vx + this.vy * this.vy)
                );
                gradient.addColorStop(0, 'rgba(255, 255, 255, 1)');
                gradient.addColorStop(0.3, 'rgba(212, 18, 161, 0.8)');
                gradient.addColorStop(1, 'rgba(212, 18, 161, 0)');

                ctx.strokeStyle = gradient;
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';

                const angle = Math.atan2(this.vy, this.vx);
                const tailX = this.x - Math.cos(angle) * this.length;
                const tailY = this.y - Math.sin(angle) * this.length;

                ctx.beginPath();
                ctx.moveTo(this.x, this.y);
                ctx.lineTo(tailX, tailY);
                ctx.stroke();

                // Bright head
                ctx.fillStyle = 'rgba(255, 255, 255, 1)';
                ctx.beginPath();
                ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
                ctx.fill();

                ctx.restore();
            }

            isOffScreen() {
                return this.x < -50 || this.x > width + 50 ||
                    this.y < -50 || this.y > height + 50 ||
                    this.life <= 0;
            }
        }

        // Comet class (long luminous tails)
        class Comet {
            constructor(manualTrigger = false) {
                // Decide entry edge and trajectory
                const angleRange = [
                    { angle: Math.PI / 4, spread: Math.PI / 12 }, // from left-top to right-bottom
                    { angle: (Math.PI * 3) / 4, spread: Math.PI / 12 }, // from right-top to left-bottom
                    { angle: (Math.PI * 5) / 4, spread: Math.PI / 12 }, // from right-bottom to left-top
                    { angle: (Math.PI * 7) / 4, spread: Math.PI / 12 }  // from left-bottom to right-top
                ];

                const preset = angleRange[Math.floor(Math.random() * angleRange.length)];
                const angle = preset.angle + (Math.random() - 0.5) * preset.spread;
                const speed = manualTrigger ? 8 + Math.random() * 2 : 5 + Math.random() * 2;

                // Spawn just outside canvas bounds in the opposite direction of travel
                const margin = 200;
                this.x = Math.cos(angle + Math.PI) * margin + width / 2;
                this.y = Math.sin(angle + Math.PI) * margin + height / 2;

                this.vx = Math.cos(angle) * speed;
                this.vy = Math.sin(angle) * speed;
                this.length = 150 + Math.random() * 120;
                this.life = 1.2; // longer life than meteors
                this.decay = 0.002 + Math.random() * 0.003;
                this.twist = (Math.random() - 0.5) * 0.002; // subtle curve
                this.hue = manualTrigger ? 320 + Math.random() * 20 : 280 + Math.random() * 30;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.vx += this.twist;
                this.vy -= this.twist / 2;
                this.life -= this.decay;
            }

            draw(ctx) {
                if (this.life <= 0) return;
                ctx.save();
                ctx.globalAlpha = Math.min(this.life, 1);

                const speed = Math.sqrt(this.vx * this.vx + this.vy * this.vy);
                const tailLength = this.length * (0.5 + speed / 10);
                const angle = Math.atan2(this.vy, this.vx);

                const tailX = this.x - Math.cos(angle) * tailLength;
                const tailY = this.y - Math.sin(angle) * tailLength;

                const gradient = ctx.createLinearGradient(this.x, this.y, tailX, tailY);
                gradient.addColorStop(0, `hsla(${this.hue}, 90%, 80%, 1)`);
                gradient.addColorStop(0.5, `hsla(${this.hue - 40}, 90%, 65%, 0.6)`);
                gradient.addColorStop(1, `hsla(${this.hue - 60}, 90%, 45%, 0)`);

                ctx.strokeStyle = gradient;
                ctx.lineWidth = 3;
                ctx.lineCap = 'round';
                ctx.beginPath();
                ctx.moveTo(this.x, this.y);
                ctx.lineTo(tailX, tailY);
                ctx.stroke();

                ctx.fillStyle = `hsla(${this.hue}, 100%, 90%, 1)`;
                ctx.shadowColor = `hsla(${this.hue}, 100%, 80%, 1)`;
                ctx.shadowBlur = 20;
                ctx.beginPath();
                ctx.arc(this.x, this.y, 4, 0, Math.PI * 2);
                ctx.fill();

                ctx.restore();
            }

            isDead() {
                return this.life <= 0 || this.x < -400 || this.x > width + 400 || this.y < -400 || this.y > height + 400;
            }
        }

        function spawnComet(manual = false) {
            comets.push(new Comet(manual));
            // Limit number of active comets
            if (comets.length > 3) {
                comets.shift();
            }
        }

        function createDustParticle() {
            return {
                x: Math.random() * width,
                y: Math.random() * height,
                size: 0.5 + Math.random() * 1.5,
                speed: 0.05 + Math.random() * 0.08,
                drift: (Math.random() - 0.5) * 0.05
            };
        }

        function scheduleBlackHole(clientX, clientY) {
            clearBlackHoleTimer();
            blackHoleTimer = setTimeout(() => {
                activateBlackHole(clientX, clientY);
            }, 1500);
        }

        function clearBlackHoleTimer() {
            if (blackHoleTimer) {
                clearTimeout(blackHoleTimer);
                blackHoleTimer = null;
            }
        }

        function activateBlackHole(clientX, clientY) {
            blackHoleActive = true;
            blackHoleStrength = 1;
            blackHoleDuration = 0;
            blackHoleSpiralRotation = 0;
            blackHoleCenter = {
                x: clientX - width / 2,
                y: clientY - height / 2
            };
        }


        // Scroll-based speed variation and meteor shower
        let scrollSpeed = 0;
        window.addEventListener('scroll', () => {
            const currentScrollY = window.scrollY;
            scrollDelta = Math.abs(currentScrollY - lastScrollY);
            lastScrollY = currentScrollY;

            scrollSpeed = Math.min(currentScrollY / 1000, 0.3); // Max 0.3 speed boost
            currentSpeed = baseSpeed + scrollSpeed;

            // Spawn meteors on scroll (with cooldown)
            meteorCooldown--;
            if (scrollDelta > 10 && meteorCooldown <= 0 && Math.random() < 0.15) {
                // Spawn 1-2 meteors
                const meteorCount = Math.random() < 0.7 ? 1 : 2;
                for (let i = 0; i < meteorCount; i++) {
                    meteors.push(new Meteor());
                }
                meteorCooldown = 30; // Cooldown to prevent spam
            }
        });

        // Star Class
        class Star {
            constructor(depthFactor = 1, speedFactor = 1) {
                this.x = Math.random() * width - width / 2;
                this.y = Math.random() * height - height / 2;
                this.z = Math.random() * width;
                this.pz = this.z;
                this.vx = 0; // Velocity for gravity well
                this.vy = 0;
                this.pulsePhase = Math.random() * Math.PI * 2; // Random pulse phase
                this.depthFactor = depthFactor;
                this.speedFactor = speedFactor;
                // Twinkling properties
                this.isTwinkling = false;
                this.twinkleIntensity = 0;
                this.twinkleTimer = Math.random() * 300 + 100; // Random initial delay
                this.twinkleDuration = 0;
                this.maxTwinkleDuration = 20 + Math.random() * 30; // Random twinkle duration
            }

            update() {
                // Warp speed effect - stars streak toward center
                if (warpSpeed && warpIntensity > 0) {
                    // Calculate direction toward center
                    const centerX = 0; // Center in 3D space
                    const centerY = 0;
                    const dx = centerX - this.x;
                    const dy = centerY - this.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    if (distance > 0) {
                        // Strong pull toward center during warp
                        const warpForce = warpIntensity * 0.15;
                        this.vx += (dx / distance) * warpForce;
                        this.vy += (dy / distance) * warpForce;
                    }

                    // Increase forward speed dramatically
                    const warpSpeedMultiplier = 1 + (warpIntensity * 8); // Up to 9x speed
                    this.z = this.z - (currentSpeed * 20 * warpSpeedMultiplier * this.speedFactor);
                } else {
                    this.z = this.z - currentSpeed * 20 * this.speedFactor; // Move star closer
                }

                // Black hole collapse pull
                if (blackHoleActive && blackHoleStrength > 0) {
                    const dx = blackHoleCenter.x - this.x;
                    const dy = blackHoleCenter.y - this.y;
                    const distanceSq = dx * dx + dy * dy + 1;
                    const pull = Math.min(0.15, (blackHoleStrength * 40) / distanceSq);
                    this.vx += dx * pull;
                    this.vy += dy * pull;

                    if (distanceSq < 15000) {
                        this.z -= blackHoleStrength * 4 * this.speedFactor;
                    }
                }

                // Apply velocity with damping
                this.x += this.vx;
                this.y += this.vy;
                this.vx *= 0.95; // Damping
                this.vy *= 0.95;

                // Twinkling logic
                this.twinkleTimer--;
                if (this.twinkleTimer <= 0) {
                    if (!this.isTwinkling) {
                        // Start twinkling (random chance)
                        if (Math.random() < 0.02) { // 2% chance per check
                            this.isTwinkling = true;
                            this.twinkleDuration = 0;
                            this.twinkleIntensity = 0;
                        } else {
                            // Reset timer for next check
                            this.twinkleTimer = Math.random() * 200 + 50;
                        }
                    }
                }

                if (this.isTwinkling) {
                    this.twinkleDuration++;
                    // Twinkle animation: fade in, peak, fade out
                    if (this.twinkleDuration < this.maxTwinkleDuration / 3) {
                        // Fade in
                        this.twinkleIntensity = (this.twinkleDuration / (this.maxTwinkleDuration / 3));
                    } else if (this.twinkleDuration < (this.maxTwinkleDuration * 2 / 3)) {
                        // Peak brightness
                        this.twinkleIntensity = 1.0;
                    } else {
                        // Fade out
                        const fadeOutProgress = (this.twinkleDuration - (this.maxTwinkleDuration * 2 / 3)) / (this.maxTwinkleDuration / 3);
                        this.twinkleIntensity = 1.0 - fadeOutProgress;
                    }

                    // End twinkling
                    if (this.twinkleDuration >= this.maxTwinkleDuration) {
                        this.isTwinkling = false;
                        this.twinkleIntensity = 0;
                        this.twinkleTimer = Math.random() * 400 + 200; // Random delay before next twinkle
                    }
                }

                if (this.z < 1) {
                    this.z = width * this.depthFactor;
                    this.x = Math.random() * width - width / 2;
                    this.y = Math.random() * height - height / 2;
                    this.pz = this.z;
                    this.vx = 0;
                    this.vy = 0;
                    // Reset twinkling when star resets
                    this.isTwinkling = false;
                    this.twinkleIntensity = 0;
                    this.twinkleTimer = Math.random() * 300 + 100;
                }
            }

            show() {
                let sx = (this.x / this.z) * width + width / 2;
                let sy = (this.y / this.z) * height + height / 2;

                let r = (1 - this.z / width) * 2.5; // Size based on distance
                this.pz = this.z;

                let brightness = (1 - this.z / width) * (0.7 + (1 / this.depthFactor) * 0.2);

                // Twinkling effect - random stars brighten periodically
                if (this.isTwinkling && this.twinkleIntensity > 0) {
                    const twinkleBoost = this.twinkleIntensity * 0.8; // Up to 80% brightness boost
                    brightness = Math.min(brightness + twinkleBoost, 1);
                    // Slight size increase during twinkle
                    r *= (1 + this.twinkleIntensity * 0.2);
                }

                ctx.beginPath();

                if (warpSpeed && warpIntensity > 0) {
                    brightness = Math.min(brightness * (1 + warpIntensity * 0.5), 1);
                    r *= (1 + warpIntensity * 0.3);
                    ctx.fillStyle = `rgba(212, 18, 161, ${brightness * (0.7 + warpIntensity * 0.3)})`;
                } else if (this.isTwinkling && this.twinkleIntensity > 0.5) {
                    const twinkleColorMix = this.twinkleIntensity * 0.4;
                    ctx.fillStyle = `rgba(${255 - twinkleColorMix * 43}, ${255 - twinkleColorMix * 237}, ${255 - twinkleColorMix * 94}, ${brightness})`;
                } else if (Math.random() > 0.97) {
                    ctx.fillStyle = `rgba(212, 18, 161, ${brightness})`;
                } else {
                    ctx.fillStyle = `rgba(255, 255, 255, ${brightness})`;
                }

                ctx.arc(sx, sy, Math.max(r * 0.5, 0.5), 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // Nebula Cloud class
        class NebulaCloud {
            constructor() {
                // Random position
                this.x = Math.random() * width;
                this.y = Math.random() * height;
                // Random size
                this.radiusX = 200 + Math.random() * 400;
                this.radiusY = 200 + Math.random() * 400;
                // Random movement speed
                this.vx = (Math.random() - 0.5) * 0.1;
                this.vy = (Math.random() - 0.5) * 0.1;
                // Color phase for shifting
                this.colorPhase = Math.random() * Math.PI * 2;
                this.colorSpeed = 0.001 + Math.random() * 0.002;
                // Opacity
                this.opacity = 0.03 + Math.random() * 0.05; // Very subtle
            }

            update() {
                // Slow movement
                this.x += this.vx;
                this.y += this.vy;

                // Wrap around edges
                if (this.x < -this.radiusX) this.x = width + this.radiusX;
                if (this.x > width + this.radiusX) this.x = -this.radiusX;
                if (this.y < -this.radiusY) this.y = height + this.radiusY;
                if (this.y > height + this.radiusY) this.y = -this.radiusY;

                // Color phase shift
                this.colorPhase += this.colorSpeed;
            }

            draw(ctx) {
                ctx.save();

                // Create radial gradient with shifting colors
                const gradient = ctx.createRadialGradient(
                    this.x, this.y, 0,
                    this.x, this.y, Math.max(this.radiusX, this.radiusY)
                );

                // Color shifts between purple, pink, and blue
                const r1 = 212 + Math.sin(this.colorPhase) * 20;
                const g1 = 18 + Math.sin(this.colorPhase + Math.PI / 3) * 30;
                const b1 = 161 + Math.sin(this.colorPhase + Math.PI * 2 / 3) * 50;

                const r2 = 100 + Math.sin(this.colorPhase + Math.PI) * 30;
                const g2 = 50 + Math.sin(this.colorPhase + Math.PI + Math.PI / 3) * 40;
                const b2 = 200 + Math.sin(this.colorPhase + Math.PI + Math.PI * 2 / 3) * 55;

                gradient.addColorStop(0, `rgba(${r1}, ${g1}, ${b1}, ${this.opacity})`);
                gradient.addColorStop(0.5, `rgba(${r2}, ${g2}, ${b2}, ${this.opacity * 0.6})`);
                gradient.addColorStop(1, `rgba(${r2}, ${g2}, ${b2}, 0)`);

                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.ellipse(this.x, this.y, this.radiusX, this.radiusY, 0, 0, Math.PI * 2);
                ctx.fill();

                ctx.restore();
            }
        }

        // Init Stars
        function initStars() {
            stars = [];
            parallaxConfigs.forEach(config => {
                const layerCount = Math.round(numStars * config.multiplier);
                for (let i = 0; i < layerCount; i++) {
                    stars.push(new Star(config.depth, config.speed));
                }
            });

            // Initialize nebula clouds (3-5 clouds)
            nebulaClouds = [];
            const cloudCount = 3 + Math.floor(Math.random() * 3);
            for (let i = 0; i < cloudCount; i++) {
                nebulaClouds.push(new NebulaCloud());
            }

            // Initialize slow space dust layer
            spaceDust = [];
            for (let i = 0; i < DUST_COUNT; i++) {
                spaceDust.push(createDustParticle());
            }
        }

        // Animation Loop
        function animate() {
            time += 0.1; // Increment time for pulsing animation

            // Update warp speed effect
            if (warpSpeed) {
                warpDuration += 1;
                // Fade out over 2 seconds (120 frames at 60fps)
                if (warpDuration > 120) {
                    warpIntensity = Math.max(0, warpIntensity - 0.05);
                    if (warpIntensity <= 0) {
                        warpSpeed = false;
                        warpIntensity = 0;
                        warpDuration = 0;
                    }
                }
            }

            ctx.fillStyle = "#050505"; // Background clear color
            ctx.fillRect(0, 0, width, height);

            // Space dust layer (behind nebula)
            ctx.save();
            ctx.fillStyle = "rgba(255, 255, 255, 0.05)";
            spaceDust.forEach(dust => {
                dust.x += dust.speed;
                dust.y += dust.drift;
                if (dust.x > width + 20) dust.x = -20;
                if (dust.x < -20) dust.x = width + 20;
                if (dust.y > height + 20) dust.y = -20;
                if (dust.y < -20) dust.y = height + 20;

                ctx.beginPath();
                ctx.arc(dust.x, dust.y, dust.size, 0, Math.PI * 2);
                ctx.fill();
            });
            ctx.restore();

            // Handle automatic comet spawns
            cometTimer++;
            if (cometTimer > cometInterval) {
                spawnComet(false);
                cometTimer = 0;
                cometInterval = 600 + Math.random() * 600;
            }

            // Draw nebula clouds (subtle background gradients)
            nebulaClouds.forEach(cloud => {
                cloud.update();
                cloud.draw(ctx);
            });

            // Warp speed visual overlay (radial gradient at center)
            if (warpSpeed && warpIntensity > 0) {
                ctx.save();
                const gradient = ctx.createRadialGradient(width / 2, height / 2, 0, width / 2, height / 2, width);
                gradient.addColorStop(0, `rgba(212, 18, 161, ${warpIntensity * 0.1})`);
                gradient.addColorStop(0.5, `rgba(212, 18, 161, ${warpIntensity * 0.05})`);
                gradient.addColorStop(1, 'rgba(212, 18, 161, 0)');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, width, height);
                ctx.restore();
            }

            // Black hole effect lifecycle
            if (blackHoleActive) {
                blackHoleDuration++;
                const fade = 1 - Math.min(blackHoleDuration / BLACK_HOLE_MAX_DURATION, 1);
                blackHoleStrength = fade;
                if (fade <= 0) {
                    blackHoleActive = false;
                    blackHoleStrength = 0;
                }
            }

            if (blackHoleActive && blackHoleStrength > 0) {
                ctx.save();
                ctx.globalCompositeOperation = 'screen';
                const radius = 120 * blackHoleStrength + 80;
                const holeX = blackHoleCenter.x + width / 2;
                const holeY = blackHoleCenter.y + height / 2;
                const holeGradient = ctx.createRadialGradient(holeX, holeY, 0, holeX, holeY, radius);
                holeGradient.addColorStop(0, `rgba(0, 0, 0, ${0.7 * blackHoleStrength})`);
                holeGradient.addColorStop(0.4, `rgba(35, 20, 10, ${0.45 * blackHoleStrength})`);
                holeGradient.addColorStop(0.8, `rgba(255, 190, 120, ${0.25 * blackHoleStrength})`);
                holeGradient.addColorStop(1, 'rgba(0,0,0,0)');
                ctx.fillStyle = holeGradient;
                ctx.beginPath();
                ctx.arc(holeX, holeY, radius, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();

                // Accretion disk (side view)
                ctx.save();
                ctx.translate(holeX, holeY);
                const diskFlatten = 0.35;
                for (let r = 60; r <= 220; r += 6) {
                    const progress = (r - 60) / 160;
                    const alpha = Math.max(0, 0.95 - progress) * blackHoleStrength;
                    if (alpha <= 0.02) continue;
                    ctx.save();
                    const wobble = Math.sin(blackHoleSpiralRotation + progress * 4) * 0.2;
                    ctx.rotate(wobble);
                    ctx.scale(1, diskFlatten);
                    ctx.lineWidth = Math.max(1.25, 5 - progress * 4);
                    const color = `rgba(255, ${190 - progress * 60}, ${120 - progress * 40}, ${alpha})`;
                    ctx.strokeStyle = color;
                    ctx.shadowColor = `rgba(255, 210, 160, ${alpha})`;
                    ctx.shadowBlur = 25 * alpha;
                    ctx.beginPath();
                    ctx.ellipse(0, 0, r, r, 0, 0, Math.PI * 2);
                    ctx.stroke();
                    ctx.restore();
                }

                // Central bright band
                ctx.save();
                ctx.scale(1, diskFlatten * 0.7);
                const bandGradient = ctx.createLinearGradient(-180, 0, 180, 0);
                bandGradient.addColorStop(0, 'rgba(255, 200, 140, 0)');
                bandGradient.addColorStop(0.5, `rgba(255, 240, 210, ${0.6 * blackHoleStrength})`);
                bandGradient.addColorStop(1, 'rgba(255, 200, 140, 0)');
                ctx.fillStyle = bandGradient;
                ctx.fillRect(-200, -18, 400, 36);
                ctx.restore();

                ctx.restore();
                blackHoleSpiralRotation += 0.012 + (0.015 * (1 - blackHoleStrength));
            }

            // Magnetic field lines near cursor
            if (magneticLines.length > 0) {
                ctx.save();
                ctx.globalCompositeOperation = 'screen';
                magneticLines = magneticLines.filter(line => {
                    line.life -= line.decay;
                    if (line.life <= 0) {
                        return false;
                    }
                    const alpha = line.life * 0.5;
                    ctx.strokeStyle = `rgba(212, 18, 161, ${alpha})`;
                    ctx.lineWidth = line.thickness;
                    ctx.beginPath();
                    ctx.arc(line.x, line.y, line.radius, line.startAngle, line.startAngle + line.span, line.direction);
                    ctx.stroke();
                    return true;
                });
                ctx.restore();
            }

            // Draw star trails (fading trails behind mouse movement)
            if (mouseTrail.length > 1) {
                ctx.save();
                for (let i = 0; i < mouseTrail.length - 1; i++) {
                    const trail = mouseTrail[i];
                    trail.life -= 0.03;

                    if (trail.life > 0 && i < mouseTrail.length - 1) {
                        const nextTrail = mouseTrail[i + 1];
                        ctx.strokeStyle = `rgba(212, 18, 161, ${trail.life * trail.intensity * 0.3})`;
                        ctx.lineWidth = 2;
                        ctx.beginPath();
                        ctx.moveTo(trail.x, trail.y);
                        ctx.lineTo(nextTrail.x, nextTrail.y);
                        ctx.stroke();
                    }
                }
                ctx.restore();

                // Remove dead trails
                mouseTrail = mouseTrail.filter(trail => trail.life > 0);
            }

            // Draw constellations (click and drag to connect stars)
            if (constellations.length > 0) {
                ctx.save();
                constellations.forEach(constellation => {
                    constellation.life -= constellation.decay;

                    if (constellation.life > 0 && constellation.points.length > 1) {
                        // Find nearby stars and connect them
                        const connectedStars = [];
                        constellation.points.forEach(point => {
                            // Find closest star to each point
                            let closestStar = null;
                            let minDist = Infinity;

                            stars.forEach(star => {
                                const sx = (star.x / star.z) * width + width / 2;
                                const sy = (star.y / star.z) * height + height / 2;
                                const dist = Math.sqrt(
                                    Math.pow(point.x - sx, 2) +
                                    Math.pow(point.y - sy, 2)
                                );

                                if (dist < 50 && dist < minDist) {
                                    minDist = dist;
                                    closestStar = { x: sx, y: sy };
                                }
                            });

                            if (closestStar) {
                                connectedStars.push(closestStar);
                            }
                        });

                        // Draw lines connecting stars
                        if (connectedStars.length > 1) {
                            ctx.strokeStyle = `rgba(212, 18, 161, ${constellation.life * 0.6})`;
                            ctx.lineWidth = 1.5;
                            ctx.setLineDash([5, 5]);
                            ctx.beginPath();
                            ctx.moveTo(connectedStars[0].x, connectedStars[0].y);

                            for (let i = 1; i < connectedStars.length; i++) {
                                ctx.lineTo(connectedStars[i].x, connectedStars[i].y);
                            }

                            ctx.stroke();
                            ctx.setLineDash([]);
                        }

                        // Draw the drawing path itself
                        if (constellation.points.length > 1) {
                            ctx.strokeStyle = `rgba(212, 18, 161, ${constellation.life * 0.4})`;
                            ctx.lineWidth = 1;
                            ctx.beginPath();
                            ctx.moveTo(constellation.points[0].x, constellation.points[0].y);

                            for (let i = 1; i < constellation.points.length; i++) {
                                ctx.lineTo(constellation.points[i].x, constellation.points[i].y);
                            }

                            ctx.stroke();
                        }
                    }
                });
                ctx.restore();

                // Remove dead constellations
                constellations = constellations.filter(c => c.life > 0);
            }

            // Draw current drawing constellation (while dragging)
            if (isDrawing && currentConstellation && currentConstellation.points.length > 1) {
                ctx.save();
                ctx.strokeStyle = `rgba(212, 18, 161, 0.6)`;
                ctx.lineWidth = 1.5;
                ctx.setLineDash([3, 3]);
                ctx.beginPath();
                ctx.moveTo(currentConstellation.points[0].x, currentConstellation.points[0].y);

                for (let i = 1; i < currentConstellation.points.length; i++) {
                    ctx.lineTo(currentConstellation.points[i].x, currentConstellation.points[i].y);
                }

                ctx.stroke();
                ctx.setLineDash([]);
                ctx.restore();
            }

            stars.forEach(star => {
                star.update();
                star.show();
            });

            // Update and draw comets
            comets.forEach(comet => {
                comet.update();
                comet.draw(ctx);
            });
            comets = comets.filter(comet => !comet.isDead());

            // Update and draw meteors
            meteors.forEach(meteor => {
                meteor.update();
                meteor.draw(ctx);
            });
            // Remove off-screen or dead meteors
            meteors = meteors.filter(meteor => !meteor.isOffScreen());

            // Update and draw particles
            particles = particles.filter(particle => {
                particle.update();
                particle.draw();
                return particle.life > 0;
            });

            requestAnimationFrame(animate);
        }

        window.addEventListener('resize', () => {
            resize();
            initStars(); // This will also reinitialize nebula clouds
        });

        // Start
        resize();
        initStars();
        animate();
    </script>
</body>

</html>